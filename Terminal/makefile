# makefile for aaOcean Terminal/Shell application

# this makefile requires fftw, openexr, ilmbase and zlib
# please visit the following URL to see how to compile these
# https://bitbucket.org/amaanakram/aaocean/wiki/Home

# $(DEPLOC) is where you have installed 'dependencies' like fftw, openexr, ilmbase, and zlib
# the following folder structure is expected under $(DEPLOC)
# $(DEPLOC)/include
# $(DEPLOC)/lib
DEPLOC      := ../../../sdks/deploy

####### NO USER-INPUT REQUIRED BEYOND THIS LINE ######

AAOCEANLOC    := ../../aaocean

# the compiler: gcc for C program, define as g++ for C++
CXX     := $(GXXLOC)g++

# compiler flags:
CXXFLAGS := -w -O2 -ffast-math -fPIC -fopenmp -fvisibility=hidden -pthread

# includes
INCLUDES := -I$(AAOCEANLOC)/externals/aaOcean/src -I$(AAOCEANLOC)/externals/helpers -I$(DEPLOC)/include -I$(DEPLOC)/include/OpenEXR

# libs where exr libs and zlib are installed:
LIBSLOC     := $(DEPLOC)/lib

# libs to link against 
LIBS     := $(LIBSLOC)/libIlmImf.a $(LIBSLOC)/libImath.a $(LIBSLOC)/libHalf.a $(LIBSLOC)/libIexMath.a $(LIBSLOC)/libIlmThread.a $(LIBSLOC)/libIex.a $(LIBSLOC)/libfftw3f.a $(LIBSLOC)/libfftw3f_omp.a $(LIBSLOC)/libz.a -Wl,-rpath -Wl,$(LIBSLOC)

# this should not be changed
LDFLAGS  := -fPIC -fopenmp -pthread -fvisibility=hidden -w -O2  

# the build target executable:
TARGET = aaOceanTerminal

all: $(TARGET)

$(TARGET): $(TARGET).cpp
	$(CXX) $(CXXFLAGS) $(INCLUDES) -o $(TARGET) $(TARGET).cpp $(LDFLAGS) -L$(LIBSLOC) $(LIBS)

clean:
	$(RM) $(TARGET)
